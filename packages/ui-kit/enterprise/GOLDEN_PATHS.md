# @zuclubit/ui-kit ‚Äî Golden Paths & Anti-Patterns Catalog

> **Version:** 1.0.0
> **Philosophy:** Make the right thing easy, make the wrong thing hard.

---

## üéØ Purpose

Este documento define:
- **Golden Paths:** La forma correcta y f√°cil de hacer las cosas
- **Anti-Patterns:** Errores comunes que deben evitarse
- **Early Warning Signs:** Se√±ales de que algo va mal
- **Recovery Patterns:** C√≥mo corregir errores

---

## üèÜ GOLDEN PATHS

### GP-001: Setup Inicial Correcto

**Objetivo:** Configurar un proyecto nuevo en menos de 30 minutos

```typescript
// ‚úÖ GOLDEN PATH: Setup completo en root

// 1. app/providers.tsx
import {
  ThemeProvider,
  GovernanceProvider,
  ENTERPRISE_POLICIES
} from '@zuclubit/ui-kit';

export function Providers({ children }: { children: React.ReactNode }) {
  return (
    <GovernanceProvider
      policies={ENTERPRISE_POLICIES.STANDARD}
      enforceMode="strict"
      onViolation={(v) => console.warn('UI-Kit violation:', v)}
    >
      <ThemeProvider defaultTheme="system" storageKey="ui-theme">
        {children}
      </ThemeProvider>
    </GovernanceProvider>
  );
}

// 2. app/layout.tsx
import { Providers } from './providers';

export default function RootLayout({ children }) {
  return (
    <html>
      <body>
        <Providers>{children}</Providers>
      </body>
    </html>
  );
}
```

**Verificaci√≥n:**
```bash
npx @zuclubit/ui-kit doctor
# ‚úì GovernanceProvider detected at root
# ‚úì ThemeProvider detected
# ‚úì ENTERPRISE_POLICIES.STANDARD loaded
# ‚úì Ready for development
```

---

### GP-002: Uso de Colores Sem√°nticos

**Objetivo:** Nunca usar colores hardcodeados en componentes

```typescript
// ‚úÖ GOLDEN PATH: Colores sem√°nticos via CSS variables

// Component using semantic tokens
function StatusBadge({ status }: { status: 'success' | 'error' | 'warning' }) {
  return (
    <span
      className={cn(
        'px-2 py-1 rounded-full text-sm',
        {
          'bg-semantic-success/10 text-semantic-success': status === 'success',
          'bg-semantic-error/10 text-semantic-error': status === 'error',
          'bg-semantic-warning/10 text-semantic-warning': status === 'warning',
        }
      )}
    >
      {status}
    </span>
  );
}

// Tailwind config (auto-generated by ui-kit)
// tailwind.config.ts
import { getTailwindConfig } from '@zuclubit/ui-kit/adapters/tailwind';

export default getTailwindConfig({
  // Tokens already included
});
```

**Verificaci√≥n:**
```bash
npx @zuclubit/ui-kit lint --no-hardcoded-colors
# ‚úì 0 hardcoded colors found
```

---

### GP-003: Accesibilidad desde el Dise√±o

**Objetivo:** Garantizar contraste accesible autom√°ticamente

```typescript
// ‚úÖ GOLDEN PATH: Usar funciones de contraste del ui-kit

import { getOptimalForeground, validateContrast } from '@zuclubit/ui-kit';

function Card({ bgColor, children }: { bgColor: string; children: React.ReactNode }) {
  // Autom√°ticamente selecciona el mejor foreground
  const textColor = getOptimalForeground(bgColor, {
    standard: 'apca-body', // Lc 60+ para texto de cuerpo
  });

  // Validaci√≥n en desarrollo
  if (process.env.NODE_ENV === 'development') {
    const { valid, ratio } = validateContrast(bgColor, textColor);
    if (!valid) {
      console.warn(`Contrast issue: ${ratio} (required: 60 Lc)`);
    }
  }

  return (
    <div style={{ backgroundColor: bgColor, color: textColor }}>
      {children}
    </div>
  );
}
```

**Verificaci√≥n:**
```bash
npx @zuclubit/ui-kit accessibility --standard=apca-body
# ‚úì All text meets Lc 60+ requirement
```

---

### GP-004: Tokens de Componente

**Objetivo:** Crear tokens de componente que heredan del sistema

```typescript
// ‚úÖ GOLDEN PATH: Tokens de componente derivados

// components/Button/Button.tokens.ts
import { deriveComponentTokens } from '@zuclubit/ui-kit';

export const buttonTokens = deriveComponentTokens('button', {
  base: {
    // Heredan de tokens sem√°nticos
    background: 'var(--color-primary)',
    foreground: 'var(--color-primary-foreground)',
    border: 'var(--color-primary-border)',
    // Valores espec√≠ficos de componente
    borderRadius: 'var(--radius-md)',
    paddingX: 'var(--spacing-4)',
    paddingY: 'var(--spacing-2)',
  },
  variants: {
    secondary: {
      background: 'var(--color-secondary)',
      foreground: 'var(--color-secondary-foreground)',
    },
    destructive: {
      background: 'var(--color-destructive)',
      foreground: 'var(--color-destructive-foreground)',
    },
  },
  states: {
    hover: {
      background: 'var(--color-primary-hover)',
    },
    disabled: {
      opacity: '0.5',
      cursor: 'not-allowed',
    },
  },
});

// Auto-registra en el token collection
// Auto-genera CSS variables
// Auto-valida accesibilidad
```

---

### GP-005: Theming Multi-tenant

**Objetivo:** Soportar branding por tenant sin duplicar c√≥digo

```typescript
// ‚úÖ GOLDEN PATH: Theming din√°mico

import { ThemeProvider, useTenantTheme } from '@zuclubit/ui-kit';

function TenantApp({ tenantId }: { tenantId: string }) {
  // Carga tema del tenant desde backend/config
  const { theme, isLoading } = useTenantTheme(tenantId);

  if (isLoading) return <Skeleton />;

  return (
    <ThemeProvider
      theme={theme}
      overrides={{
        // Solo overrides espec√≠ficos del tenant
        colors: {
          primary: theme.brandColor,
        },
      }}
    >
      <App />
    </ThemeProvider>
  );
}

// Los componentes NO necesitan cambios
// El tema se aplica via CSS variables
```

---

### GP-006: Migraci√≥n de Legacy

**Objetivo:** Migrar c√≥digo legacy sin breaking changes

```typescript
// ‚úÖ GOLDEN PATH: Migraci√≥n gradual con coexistencia

// Phase 1: Wrapper de coexistencia
import { LegacyBridge } from '@zuclubit/ui-kit/migration';

function LegacyModule() {
  return (
    <LegacyBridge
      tokenMapping={{
        // Mapea tokens legacy a nuevos
        '--old-primary': 'var(--color-primary)',
        '--old-text': 'var(--color-foreground)',
      }}
      validateOnRender={process.env.NODE_ENV === 'development'}
    >
      <OldComponent />
    </LegacyBridge>
  );
}

// Phase 2: Reemplazo gradual
// npx @zuclubit/ui-kit migrate --dry-run
// npx @zuclubit/ui-kit migrate --apply

// Phase 3: Remover LegacyBridge
// Eliminar cuando todos los tokens est√©n migrados
```

---

### GP-007: Validaci√≥n en Development

**Objetivo:** Detectar problemas antes del commit

```typescript
// ‚úÖ GOLDEN PATH: Hooks de desarrollo

// hooks/useDevValidation.ts
import { useLiveConformance, useComponentAudit } from '@zuclubit/ui-kit';

export function useDevValidation() {
  // Solo en desarrollo
  if (process.env.NODE_ENV !== 'development') {
    return { violations: [], warnings: [] };
  }

  // Validaci√≥n en tiempo real
  const conformance = useLiveConformance();
  const audit = useComponentAudit();

  // Mostrar overlay de desarrollo
  useEffect(() => {
    if (conformance.violations.length > 0) {
      showDevOverlay(conformance.violations);
    }
  }, [conformance.violations]);

  return { violations: conformance.violations, warnings: audit.warnings };
}
```

```typescript
// Configurar DevTools
// ui-kit.config.ts
export default {
  devtools: {
    enabled: process.env.NODE_ENV === 'development',
    showViolations: true,
    highlightIssues: true,
    logToConsole: true,
    overlay: {
      position: 'bottom-right',
      maxHeight: '300px',
    },
  },
};
```

---

### GP-008: Reportes Autom√°ticos

**Objetivo:** Generar reportes sin intervenci√≥n manual

```yaml
# ‚úÖ GOLDEN PATH: CI/CD con reportes

# .github/workflows/ui-kit-report.yml
- name: Generate Quality Report
  run: |
    npx @zuclubit/ui-kit report \
      --format=markdown \
      --output=QUALITY_REPORT.md

- name: Update PR with Report
  uses: actions/github-script@v7
  with:
    script: |
      const fs = require('fs');
      const report = fs.readFileSync('QUALITY_REPORT.md', 'utf8');
      github.rest.issues.createComment({
        issue_number: context.issue.number,
        owner: context.repo.owner,
        repo: context.repo.repo,
        body: report
      });
```

---

## üö´ ANTI-PATTERNS

### AP-001: Colores Hardcodeados

**Descripci√≥n:** Usar valores hex/rgb directamente en componentes

```typescript
// ‚ùå ANTI-PATTERN: Hardcoded colors
function BadButton() {
  return (
    <button
      style={{
        backgroundColor: '#3b82f6', // ‚ùå Hardcoded
        color: 'white',             // ‚ùå Hardcoded
        border: '1px solid #2563eb' // ‚ùå Hardcoded
      }}
    >
      Click me
    </button>
  );
}

// ‚ùå Tambi√©n en Tailwind
function AlsoBad() {
  return (
    <button className="bg-[#3b82f6] text-white border-[#2563eb]">
      Click me
    </button>
  );
}
```

**Por qu√© es malo:**
- Rompe theming (dark mode, tenants)
- No es auditable
- Inconsistencia visual
- Imposible mantener

**C√≥mo detectar:**
```bash
npx @zuclubit/ui-kit lint --no-hardcoded-colors
# ‚úó 3 hardcoded colors found
#   src/components/Button.tsx:12 - #3b82f6
#   src/components/Button.tsx:13 - white
#   src/components/Button.tsx:14 - #2563eb
```

**C√≥mo corregir:**
```typescript
// ‚úÖ CORRECT: Use semantic tokens
function GoodButton() {
  return (
    <button className="bg-primary text-primary-foreground border-primary-border">
      Click me
    </button>
  );
}
```

---

### AP-002: Bypass de Governance

**Descripci√≥n:** Desactivar governance para "ir m√°s r√°pido"

```typescript
// ‚ùå ANTI-PATTERN: Disabling governance
<GovernanceProvider
  policies={ENTERPRISE_POLICIES.STANDARD}
  enforceMode="off"  // ‚ùå NUNCA hacer esto
>
  <App />
</GovernanceProvider>

// ‚ùå Tambi√©n via env vars
// .env
UI_KIT_GOVERNANCE=disabled  // ‚ùå No existe, no funcionar√°

// ‚ùå Intentar bypass con wrapper
function UnsafeWrapper({ children }) {
  // ‚ùå Esto no hace nada, governance es heredada
  return <div data-no-governance>{children}</div>;
}
```

**Por qu√© es malo:**
- Deuda t√©cnica instant√°nea
- Violaciones se acumulan
- Corregir despu√©s es 10x m√°s caro
- Rompe consistencia cross-product

**C√≥mo detectar:**
```bash
npx @zuclubit/ui-kit check-provider
# ‚úó GovernanceProvider found with enforceMode="off"
# ‚úó This is a policy violation
```

**C√≥mo corregir:**
```typescript
// ‚úÖ CORRECT: Use warn mode during development
<GovernanceProvider
  policies={ENTERPRISE_POLICIES.STANDARD}
  enforceMode={process.env.NODE_ENV === 'development' ? 'warn' : 'strict'}
>
  <App />
</GovernanceProvider>
```

---

### AP-003: Tokens Sin Registrar

**Descripci√≥n:** Crear tokens custom sin registrarlos

```typescript
// ‚ùå ANTI-PATTERN: Unregistered tokens
const customStyles = {
  '--my-custom-color': '#ff0000',  // ‚ùå No registrado
  '--my-spacing': '24px',          // ‚ùå No registrado
};

function BadComponent() {
  return (
    <div style={customStyles}>
      <p style={{ color: 'var(--my-custom-color)' }}>
        Text
      </p>
    </div>
  );
}
```

**Por qu√© es malo:**
- No aparece en auditor√≠as
- No se valida accesibilidad
- No se exporta a Figma/Style Dictionary
- Inconsistencia

**C√≥mo detectar:**
```bash
npx @zuclubit/ui-kit lint --no-unregistered-tokens
# ‚úó 2 unregistered tokens found
#   --my-custom-color (src/styles.ts:2)
#   --my-spacing (src/styles.ts:3)
```

**C√≥mo corregir:**
```typescript
// ‚úÖ CORRECT: Register tokens properly
import { registerProductTokens } from '@zuclubit/ui-kit';

// Register at app init
registerProductTokens('my-product', {
  colors: {
    'custom-accent': {
      value: '#ff0000',
      description: 'Accent color for highlights',
      // Autom√°ticamente validado
    },
  },
  spacing: {
    'custom-lg': {
      value: '24px',
      description: 'Large custom spacing',
    },
  },
});

// Use registered tokens
function GoodComponent() {
  return (
    <div className="text-custom-accent spacing-custom-lg">
      Text
    </div>
  );
}
```

---

### AP-004: Ignorar Warnings de Accesibilidad

**Descripci√≥n:** Marcar warnings como "false positive" sin investigar

```typescript
// ‚ùå ANTI-PATTERN: Suppressing a11y warnings
function BadCard() {
  return (
    // ‚ùå Suppressing without understanding
    // @ts-ignore: A11Y_CONTRAST_LOW
    <div className="bg-gray-100 text-gray-300">
      Low contrast text
    </div>
  );
}

// ‚ùå Tambi√©n en config
// ui-kit.config.ts
export default {
  accessibility: {
    ignoreWarnings: ['contrast-low'],  // ‚ùå NUNCA
  },
};
```

**Por qu√© es malo:**
- Usuarios con discapacidad visual no pueden usar
- Posible violaci√≥n legal (ADA, EAA)
- UX degradado para todos en condiciones adversas

**C√≥mo detectar:**
```bash
npx @zuclubit/ui-kit accessibility --verbose
# ‚ö†Ô∏è 5 warnings suppressed via comments/config
# This is a policy violation
```

**C√≥mo corregir:**
```typescript
// ‚úÖ CORRECT: Fix the actual issue
import { getOptimalForeground } from '@zuclubit/ui-kit';

function GoodCard() {
  const bgColor = 'var(--color-muted)';
  const textColor = getOptimalForeground(bgColor, { standard: 'wcag-aa' });

  return (
    <div style={{ backgroundColor: bgColor, color: textColor }}>
      Accessible text
    </div>
  );
}
```

---

### AP-005: Copy-Paste de Componentes UI-Kit

**Descripci√≥n:** Copiar c√≥digo de componentes en lugar de importarlos

```typescript
// ‚ùå ANTI-PATTERN: Copy-pasting component code
// components/Button.tsx
// "Copied from ui-kit and modified"
export function Button({ variant = 'default', ...props }) {
  // ... 200 lines of copied code
  // ... with "small modifications"
}

// ‚ùå Ahora tienes:
// - Duplicaci√≥n
// - No recibe updates
// - Posibles bugs introducidos
// - Sin validaci√≥n de governance
```

**Por qu√© es malo:**
- Divergencia inevitable
- No recibe bug fixes
- Sin governance
- Mantenimiento doble

**C√≥mo detectar:**
```bash
npx @zuclubit/ui-kit detect-duplicates
# ‚ö†Ô∏è Potential duplicate of @zuclubit/ui-kit/Button
#    src/components/Button.tsx (87% similarity)
```

**C√≥mo corregir:**
```typescript
// ‚úÖ CORRECT: Extend via composition
import { Button as BaseButton } from '@zuclubit/ui-kit';

// Extend with custom variants
export function Button({ variant, ...props }) {
  const customVariants = {
    'brand-special': 'bg-brand-accent text-white',
  };

  return (
    <BaseButton
      className={customVariants[variant]}
      {...props}
    />
  );
}

// ‚úÖ Or use the slots pattern
import { Button } from '@zuclubit/ui-kit';

<Button
  slots={{
    root: ({ children }) => <div className="custom-wrapper">{children}</div>,
  }}
>
  Click me
</Button>
```

---

### AP-006: M√∫ltiples ThemeProviders

**Descripci√≥n:** Anidar m√∫ltiples providers de tema

```typescript
// ‚ùå ANTI-PATTERN: Nested theme providers
function App() {
  return (
    <ThemeProvider theme="light">
      <Header />
      <ThemeProvider theme="dark">  {/* ‚ùå Nested! */}
        <Sidebar />
      </ThemeProvider>
      <ThemeProvider theme="light">  {/* ‚ùå Another nested! */}
        <Content />
      </ThemeProvider>
    </ThemeProvider>
  );
}
```

**Por qu√© es malo:**
- Performance overhead
- Comportamiento impredecible
- CSS variable conflicts
- Debugging nightmare

**C√≥mo detectar:**
```bash
npx @zuclubit/ui-kit check-provider --detect-nesting
# ‚úó Multiple ThemeProvider instances detected
#   Root: app/layout.tsx:15
#   Nested: components/Sidebar.tsx:8
#   Nested: components/Content.tsx:12
```

**C√≥mo corregir:**
```typescript
// ‚úÖ CORRECT: Single provider, component-level overrides
function App() {
  return (
    <ThemeProvider theme="light">
      <Header />
      <Sidebar data-theme="dark" />  {/* ‚úÖ Override via data attr */}
      <Content />
    </ThemeProvider>
  );
}

// CSS handles the override
// [data-theme="dark"] uses dark CSS variables
```

---

## ‚ö†Ô∏è EARLY WARNING SIGNS

### EWS-001: Conformance Score Dropping

| Signal | Meaning | Action |
|--------|---------|--------|
| Score drops 5+ points in 1 week | New violations introduced | Review recent PRs |
| Score plateau below 75 | Technical debt accumulating | Sprint allocation needed |
| Score variance > 10 between modules | Inconsistent adoption | Module-specific training |

### EWS-002: Token Coverage Declining

| Signal | Meaning | Action |
|--------|---------|--------|
| Coverage drops 3+ points | New hardcoded values | Run lint on recent PRs |
| Custom tokens growing fast | Possible divergence | Review token registration |
| Unused tokens > 20% | Bloated token set | Deprecation review |

### EWS-003: Exception Rate Rising

| Signal | Meaning | Action |
|--------|---------|--------|
| > 5 exceptions in 1 week | Policies too strict OR bypassed | Policy review meeting |
| Same exception repeated | Systemic issue | Update policy or training |
| Exceptions not expiring | Tracking failure | Audit exception registry |

### EWS-004: Build Failure Rate Spiking

| Signal | Meaning | Action |
|--------|---------|--------|
| > 10% builds fail UI-Kit | Major breaking change | Emergency review |
| Same failure repeating | Knowledge gap | Targeted training |
| Failures only in one team | Adoption issue | Team-specific support |

---

## üîÑ RECOVERY PATTERNS

### RP-001: Recovering from Low Conformance

```bash
# 1. Identify top violators
npx @zuclubit/ui-kit audit --top-violations=10

# 2. Prioritize by impact
npx @zuclubit/ui-kit triage --severity=critical

# 3. Auto-fix what's possible
npx @zuclubit/ui-kit fix --auto --dry-run
npx @zuclubit/ui-kit fix --auto --apply

# 4. Create tickets for manual fixes
npx @zuclubit/ui-kit export-issues --format=jira
```

### RP-002: Recovering from Token Drift

```bash
# 1. Detect all unregistered tokens
npx @zuclubit/ui-kit token-audit --unregistered

# 2. Generate registration code
npx @zuclubit/ui-kit token-register --generate

# 3. Map hardcoded to semantic
npx @zuclubit/ui-kit token-migrate --interactive
```

### RP-003: Recovering from Accessibility Violations

```bash
# 1. Full accessibility audit
npx @zuclubit/ui-kit accessibility --full --output=a11y-audit.json

# 2. Generate fix suggestions
npx @zuclubit/ui-kit accessibility --suggest-fixes

# 3. Apply auto-fixable issues
npx @zuclubit/ui-kit accessibility --fix --apply
```

---

## üìã Quick Reference Card

### ‚úÖ Always Do

| Practice | Command to Verify |
|----------|-------------------|
| Use GovernanceProvider | `npx @zuclubit/ui-kit check-provider` |
| Use semantic tokens | `npx @zuclubit/ui-kit lint --no-hardcoded` |
| Register custom tokens | `npx @zuclubit/ui-kit token-audit` |
| Fix a11y issues immediately | `npx @zuclubit/ui-kit accessibility` |
| Run conformance before PR | `npx @zuclubit/ui-kit conformance` |

### ‚ùå Never Do

| Anti-Pattern | Detection |
|--------------|-----------|
| Hardcode colors | `--no-hardcoded-colors` |
| Bypass governance | `check-provider` |
| Ignore a11y warnings | `accessibility --verbose` |
| Copy component code | `detect-duplicates` |
| Nest ThemeProviders | `check-provider --detect-nesting` |

---

> **Regla de Oro:** Si tienes que "hacer un workaround" para algo del UI-Kit, probablemente est√°s haciendo algo mal. Pregunta primero.
